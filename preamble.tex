\usepackage[margin=1in]{geometry}
\usepackage{xcolor}
\usepackage{bytefield}
\usepackage{sectsty}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amsfonts}
\usepackage{framed}
\usepackage[style=trad-abbrv,doi=true,url=true,isbn=false,backend=biber]{biblatex}
\usepackage{setspace}
\usepackage{algpseudocode}
\usepackage{algorithm}
\usepackage{hyperref}
\usepackage[nameinlink,capitalise]{cleveref}
% \setlength{\parskip}{6pt}
\onehalfspacing


% Code listings
\usepackage[outputdir=build,newfloat]{minted}
\usepackage{caption}
\newenvironment{code}{\captionsetup{type=listing}}{}
\SetupFloatingEnvironment{listing}{name=Julia snippet}

% Colors
\definecolor{lightblue}{HTML}{eef6f8}
\definecolor{darkblue}{HTML}{315a88}
\definecolor{lightgreen}{HTML}{eef8f6}
\definecolor{lightred}{HTML}{f8f6ee}
\hypersetup{%
    linktocpage=true,
    colorlinks=true,
    urlcolor=darkblue,
    linkcolor=darkblue,
    citecolor=darkblue,
    pdfauthor={Urbain Vaes}
    pdftitle={Lecture notes in Numerical Analysis}
    pdfsubject={Applied mathematics}
}

% Fonts for lualatex
\usepackage{fontspec}
% \setmonofont{Monaco}[Scale=MatchLowercase,BoldFont=DejaVu sans Mono-bold]
% \setmonofont{DejaVu sans Mono}[Scale=MatchLowercase,BoldFont=DejaVu sans Mono-bold]
\setmonofont{Latin Modern Mono}[Scale=MatchLowercase,ItalicFont=Latin Modern Mono]
% \setmainfont{DejaVu Serif}
\usepackage{newunicodechar}
% To check that a font supports Greek letters, try 'albatross α'
\newfontfamily{\fallbackfont}{DejaVu Sans Mono}[Scale=MatchLowercase]
\DeclareTextFontCommand{\textfallback}{\fallbackfont}
\newunicodechar{α}{\textfallback{α}}
\newunicodechar{β}{\textfallback{β}}
\newunicodechar{γ}{\textfallback{γ}}
\newunicodechar{δ}{\textfallback{δ}}
\newunicodechar{ε}{\textfallback{ε}}
\newunicodechar{ζ}{\textfallback{ζ}}
\newunicodechar{η}{\textfallback{η}}
\newunicodechar{θ}{\textfallback{θ}}
\newunicodechar{ι}{\textfallback{ι}}
\newunicodechar{κ}{\textfallback{κ}}
\newunicodechar{λ}{\textfallback{λ}}
\newunicodechar{μ}{\textfallback{μ}}
\newunicodechar{ν}{\textfallback{ν}}
\newunicodechar{ξ}{\textfallback{ξ}}
\newunicodechar{ο}{\textfallback{ο}}
\newunicodechar{π}{\textfallback{π}}
\newunicodechar{ρ}{\textfallback{ρ}}
\newunicodechar{σ}{\textfallback{σ}}
\newunicodechar{τ}{\textfallback{τ}}
\newunicodechar{υ}{\textfallback{υ}}
\newunicodechar{φ}{\textfallback{φ}}
\newunicodechar{χ}{\textfallback{χ}}
\newunicodechar{ψ}{\textfallback{ψ}}
\newunicodechar{ω}{\textfallback{ω}}
\newunicodechar{Α}{\textfallback{Α}}
\newunicodechar{Β}{\textfallback{Β}}
\newunicodechar{Γ}{\textfallback{Γ}}
\newunicodechar{Δ}{\textfallback{Δ}}
\newunicodechar{Ε}{\textfallback{Ε}}
\newunicodechar{Ζ}{\textfallback{Ζ}}
\newunicodechar{Η}{\textfallback{Η}}
\newunicodechar{Θ}{\textfallback{Θ}}
\newunicodechar{Ι}{\textfallback{Ι}}
\newunicodechar{Κ}{\textfallback{Κ}}
\newunicodechar{Λ}{\textfallback{Λ}}
\newunicodechar{Μ}{\textfallback{Μ}}
\newunicodechar{Ν}{\textfallback{Ν}}
\newunicodechar{Ξ}{\textfallback{Ξ}}
\newunicodechar{Ο}{\textfallback{Ο}}
\newunicodechar{Π}{\textfallback{Π}}
\newunicodechar{Ρ}{\textfallback{Ρ}}
\newunicodechar{Σ}{\textfallback{Σ}}
\newunicodechar{Τ}{\textfallback{Τ}}
\newunicodechar{Υ}{\textfallback{Υ}}
\newunicodechar{Φ}{\textfallback{Φ}}
\newunicodechar{Χ}{\textfallback{Χ}}
\newunicodechar{Ψ}{\textfallback{Ψ}}
\newunicodechar{Ω}{\textfallback{Ω}}

% Style of sections
\allsectionsfont{\sffamily}
\sectionfont{\sffamily\color{darkblue}}

% Numbering of equations
\numberwithin{equation}{chapter}

% Equations and theorems
\theoremstyle{plain}% default
\newtheorem{prototheorem}{Theorem}[chapter]
\newtheorem{protoproposition}[prototheorem]{Proposition}
\newtheorem{protolemma}[prototheorem]{Lemma}
\newtheorem{protocorollary}[prototheorem]{Corollary}
\newtheorem{protoexercise}{Exercise}[chapter]
\theoremstyle{definition}
\newtheorem{protodefinition}{Definition}[chapter]
\newtheorem{protonotation}{Notation}[chapter]
\theoremstyle{remark}
\newtheorem{protoexample}{Example}[chapter]
\newtheorem{protoremark}{Remark}[chapter]
\newtheorem*{solution}{Solution}

% Minitoc
\usepackage[nohints]{minitoc}
\setcounter{tocdepth}{1}
\setcounter{minitocdepth}{1}
\renewcommand{\mtctitle}{}
\nomtcrule

% Styling of Theorems
\colorlet{theoremcolor}{lightblue}
\colorlet{propositioncolor}{lightblue}
\colorlet{lemmacolor}{lightblue}
\colorlet{corollarycolor}{lightblue}
\colorlet{examplecolor}{lightblue}
\colorlet{definitioncolor}{lightblue}
\colorlet{notationcolor}{lightblue}
\colorlet{remarkcolor}{lightblue}
\newenvironment{theorem}
   {\colorlet{shadecolor}{theoremcolor}\begin{shaded}\begin{prototheorem}}
   {\end{prototheorem}\end{shaded}}
\newenvironment{proposition}
   {\colorlet{shadecolor}{propositioncolor}\begin{shaded}\begin{protoproposition}}
   {\end{protoproposition}\end{shaded}}
\newenvironment{lemma}
   {\colorlet{shadecolor}{lemmacolor}\begin{shaded}\begin{protolemma}}
   {\end{protolemma}\end{shaded}}
\newenvironment{corollary}
   {\colorlet{shadecolor}{corollarycolor}\begin{shaded}\begin{protocorollary}}
   {\end{protocorollary}\end{shaded}}
\newenvironment{example}
   {\colorlet{shadecolor}{examplecolor}\begin{shaded}\begin{protoexample}}
   {\end{protoexample}\end{shaded}}
\newenvironment{definition}
   {\colorlet{shadecolor}{definitioncolor}\begin{shaded}\begin{protodefinition}}
   {\end{protodefinition}\end{shaded}}
\newenvironment{notation}
   {\colorlet{shadecolor}{notationcolor}\begin{shaded}\begin{protonotation}}
   {\end{protonotation}\end{shaded}}
\newenvironment{remark}
   {\colorlet{shadecolor}{remarkcolor}\begin{shaded}\begin{protoremark}}
   {\end{protoremark}\end{shaded}}
\newenvironment{exercise}
   {\colorlet{shadecolor}{white}\begin{protoexercise}}
   {\end{protoexercise}}

% Links
\crefname{protolemma}{Lemma}{Lemmas}
\crefname{prototheorem}{Theorem}{Theorems}
\crefname{protoproposition}{Proposition}{Propositions}
\crefname{protocorollary}{Corollary}{Corollarys}
\crefname{protoexample}{Example}{Examples}
\crefname{protodefinition}{Definition}{Definitions}
\crefname{protoremark}{Remark}{Remarks}
% \crefname{algorithm}{Algorithm}{Algorithms}
% \Crefname{algorithm}{Algorithm}{Algorithms}

% Bibliography
\addbibresource{main.bib}
\renewcommand*{\mkbibnamegiven}[1]{\textsc{#1}}
\renewcommand*{\mkbibnamefamily}[1]{\textsc{#1}}
\DeclareFieldFormat{volume}{volume \textbf{#1}}
\DeclareFieldFormat[article]{volume}{\textbf{#1}}
\DeclareFieldFormat[book]{note}{}
\DeclareFieldFormat[book]{pages}{}
\DeclareFieldFormat{url}{\newline {\scriptsize\textsc{url}: \url{#1}}}
\DeclareFieldFormat{doi}{\newline {\scriptsize\textsc{doi}: \url{#1}}}
\renewcommand*{\bibfont}{\small}

% Custom cite command
\DeclareCiteCommand{\fullcite}
  {\usebibmacro{prenote}}
  {\clearfield{doi}%
   \clearfield{pages}%
   \clearfield{pagetotal}%
   \clearfield{edition}%
   \clearfield{labelyear}%
   \usedriver
     {\DeclareNameAlias{sortname}{default}}
     {\thefield{entrytype}}}
  {\multicitedelim}
  {\usebibmacro{postnote}}

% Headers
\usepackage{fancyhdr}
\usepackage{emptypage}

% Clear defaults
\fancyhead{}

% Left-Odd, Right-Even
\definecolor{darkgrey}{RGB}{120,120,120}
\fancyhead[LE,RO]{\color{darkgrey}\textit{\nouppercase{\leftmark}}}
% \fancyhead[LO,RE]{\color{darkgrey}\textit{\thepage}}
\fancyhead[LO,RE]{}
\fancyfoot[C]{\color{darkgrey}\textit{\thepage}}
\pagestyle{fancy}
\let\oldheadrule\headrule
\renewcommand{\headrule}{}
% \renewcommand{\headrule}{\color{darkgrey}\oldheadrule}
% \renewcommand{\headrulewidth}{0pt}
\setlength{\headheight}{13.59999pt}
